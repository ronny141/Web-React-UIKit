{"version":3,"file":"index.modern.js","sources":["../src/RtcContext.tsx","../src/PropsContext.tsx","../src/MaxUidContext.tsx","../src/MinUidContext.tsx","../src/TracksContext.tsx","../src/Reducer.tsx","../src/RTCConfigure.tsx","../src/Controls/Icons.tsx","../src/Controls/BtnTemplate.tsx","../src/LocalUserContext.tsx","../src/Controls/Local/muteAudio.ts","../src/Controls/Local/LocalAudioMute.tsx","../src/Controls/Local/muteVideo.ts","../src/Controls/Local/LocalVideoMute.tsx","../src/Controls/LocalControls.tsx","../src/RtmContext.tsx","../src/Controls/Remote/RemoteVideoMute.tsx","../src/Controls/Remote/RemoteAudioMute.tsx","../src/Controls/SwapUser.tsx","../src/VideoPlaceholder.tsx","../src/Username.tsx","../src/MaxVideoView.tsx","../src/MinVideoView.tsx","../src/PinnedVideo.tsx","../src/GridVideo.tsx","../src/TracksConfigure.tsx","../src/RTMConfigure.tsx","../src/Controls/Remote/RemoteMutePopUp.tsx","../src/AgoraUIKit.tsx","../src/Controls/Local/EndCall.tsx"],"sourcesContent":["import React from 'react'\nimport {\n  IAgoraRTCClient,\n  ILocalAudioTrack,\n  ILocalVideoTrack,\n  UID\n} from 'agora-rtc-react'\nimport { CallbacksInterface, mediaStore } from './PropsContext'\n\nexport type DispatchType = <\n  T extends keyof CallbacksInterface,\n  V extends Parameters<CallbacksInterface[T]>\n>(action: {\n  type: T\n  value: V\n}) => void\n\n/**\n * Interface for the RtcContext\n */\nexport interface RtcContextInterface {\n  /**\n   * The client object used by the web SDK\n   */\n  client: IAgoraRTCClient\n  /**\n   * The local user's video track\n   */\n  localVideoTrack: ILocalVideoTrack | null\n  /**\n   * The local user's audio track\n   */\n  localAudioTrack: ILocalAudioTrack | null\n  /**\n   * An object containing a key value store of tracks mapped to users UIDs\n   */\n  mediaStore: mediaStore\n  /**\n   * React dispatch to update values in the reducer\n   */\n  dispatch: DispatchType\n  /**\n   * The local UID returned by the SDK when using local uid as 0.\n   */\n  localUid: React.MutableRefObject<UID | undefined>\n  /**\n   * Is the UIKit in a channel\n   */\n  channelJoined: boolean\n}\n/**\n * Context to access local/remote tracks, client, dispatch and localuid. It's setup by {@link RtcConfigure}.\n */\nconst RtcContext = React.createContext<RtcContextInterface>(\n  {} as RtcContextInterface\n)\n\nexport interface ActionInterface<T extends keyof CallbacksInterface> {\n  type: T\n  value: Parameters<CallbacksInterface[T]>\n}\nexport type ActionType<T extends keyof CallbacksInterface> = ActionInterface<T>\n\nexport const RtcProvider = RtcContext.Provider\nexport const RtcConsumer = RtcContext.Consumer\nexport default RtcContext\n","import {\n  IAgoraRTCClient,\n  VideoPlayerConfig,\n  IRemoteAudioTrack,\n  IRemoteVideoTrack,\n  ILocalVideoTrack,\n  ILocalAudioTrack,\n  UID,\n  RemoteStreamFallbackType,\n  ConnectionState,\n  ConnectionDisconnectedReason,\n  IAgoraRTCRemoteUser,\n  RemoteStreamType,\n  ChannelMediaRelayState,\n  ChannelMediaRelayError,\n  ChannelMediaRelayEvent,\n  NetworkQuality,\n  AgoraRTCError,\n  IMicrophoneAudioTrack,\n  ICameraVideoTrack\n} from 'agora-rtc-react'\n// import {RtmChannelEvents} from 'agora-rtm-react'\nimport React from 'react'\nimport { rtmCallbacks } from './RtmContext'\n\ninterface media {\n  videoTrack?: IRemoteVideoTrack\n  audioTrack?: IRemoteAudioTrack\n}\ninterface localMedia {\n  videoTrack?: ILocalVideoTrack\n  audioTrack?: ILocalAudioTrack\n}\n\nexport type mediaStore = {\n  [key in UID]: media | localMedia\n}\n\nexport enum remoteTrackState {\n  yes = 0, // remote published\n  subbed = 1, // remote published and subscribed\n  no = 2 // remote unpublished\n}\n\n/**\n * Data type for a UIKitUser\n */\nexport type UIKitUser = RemoteUIKitUser | LocalUIKitUser\nexport interface LocalUIKitUser {\n  /**\n   * The ID of the remote user.\n   */\n  uid: 0\n  /**\n   * Whether the remote user is sending an audio track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasAudio: ToggleState\n  /**\n   * Whether the remote user is sending a video track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasVideo: ToggleState\n}\nexport interface RemoteUIKitUser {\n  /**\n   * The ID of the remote user.\n   */\n  uid: UID\n  /**\n   * Whether the remote user is sending an audio track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasAudio: remoteTrackState\n  /**\n   * Whether the remote user is sending a video track.\n   * - `true`: The remote user is sending an audio track.\n   * - `false`: The remote user is not sending an audio track.\n   */\n  hasVideo: remoteTrackState\n}\n\n/**\n * Remote Buttons styles\n */\ninterface remoteBtnStylesInterface {\n  /**\n   * Style for the remote mute audio button\n   */\n  muteRemoteAudio?: React.CSSProperties\n  /**\n   * Style for the remote mute video button\n   */\n  muteRemoteVideo?: React.CSSProperties\n  /**\n   * Style for the remote swap button in pinned layout\n   */\n  remoteSwap?: React.CSSProperties\n  /**\n   * Style for the overlay close button\n   */\n  minCloseBtnStyles?: React.CSSProperties\n}\n\n/**\n * Local Buttons styles\n */\ninterface localBtnStylesInterface {\n  /**\n   * Style for the local mute audio button\n   */\n  muteLocalAudio?: React.CSSProperties\n  /**\n   * Style for the local mute video button\n   */\n  muteLocalVideo?: React.CSSProperties\n  /**\n   * Style for the switch camera button\n   */\n  switchCamera?: React.CSSProperties\n  /**\n   * Style for the end call button\n   */\n  endCall?: React.CSSProperties\n}\n\n/**\n * Props object for customising the UI Kit, takes in react native styling\n */\nexport interface StylePropInterface {\n  /**\n   * Sets the scaling of the video\n   */\n  videoMode?: {\n    max?: VideoPlayerConfig['fit']\n    min?: VideoPlayerConfig['fit']\n  }\n  /**\n   * Color tint for icons\n   */\n  theme?: string\n  /**\n   * Color tint for icons\n   */\n  iconSize?: number\n  /**\n   * Custom base64 string for icon\n   */\n  customIcon?: Partial<IconsInterface>\n  /**\n   * Globals style for the local buttons (except end call)\n   */\n  BtnTemplateStyles?: React.CSSProperties\n  /**\n   * Style for the big view in pinned layout\n   */\n  maxViewStyles?: React.CSSProperties\n  /**\n   * Style for the small view in pinned layout\n   */\n  minViewStyles?: React.CSSProperties\n  /**\n   * Style for the small view container\n   */\n  minViewContainer?: React.CSSProperties\n  /**\n   * Style for the big view container\n   */\n  maxViewContainer?: React.CSSProperties\n  /**\n   * Style for the overlay on small user view when pressed in pinned layout\n   */\n  minViewOverlayContainer?: React.CSSProperties\n  /**\n   * Style for the overlay on small user view when pressed in pinned layout\n   */\n  maxViewOverlayContainer?: React.CSSProperties\n  /**\n   * Style for the remote button\n   */\n  remoteBtnStyles?: remoteBtnStylesInterface\n  /**\n   * Style for the remote button container\n   */\n  remoteBtnContainer?: React.CSSProperties\n  /**\n   * Style for specific local buttons, overrides the style applied by BtnTemplateStyles prop\n   */\n  localBtnStyles?: localBtnStylesInterface\n  /**\n   * Style for the local button container\n   */\n  localBtnContainer?: React.CSSProperties\n  /**\n   * Applies style to the individual cell (view) containing the video in the grid layout\n   */\n  gridVideoCells?: React.CSSProperties\n  /**\n   * Applies style to the grid container\n   */\n  gridVideoContainer?: React.CSSProperties\n  /**\n   * Applies style to the grid container\n   */\n  pinnedVideoContainer?: React.CSSProperties\n  /**\n   * Applies style to the pinned scrollview container\n   */\n  scrollViewContainer?: React.CSSProperties\n  /**\n   * Applies style to the global view containing the UI Kit\n   */\n  UIKitContainer?: React.CSSProperties\n  /**\n   * Applies style to the pop up container for remote mute requests\n   */\n  popUpContainer?: React.CSSProperties\n  /**\n   * Applies style to the displayed username text container\n   */\n  usernameText?: React.CSSProperties\n}\n\n/**\n * Props for the VideoPlaceholder component\n */\nexport interface VideoPlaceholderProps {\n  user: UIKitUser\n  /**\n   * State value to display buttons\n   */\n  isShown: boolean\n  showButtons?: boolean\n  showSwap?: boolean\n}\n\n/**\n * Props object for customising the UI Kit functionality\n */\nexport interface RtcPropsInterface {\n  /**\n   * React functional component for overriding the default video placeholder\n   */\n  CustomVideoPlaceholder?: React.FunctionComponent<VideoPlaceholderProps>\n  /**\n   * Agora App ID - used to authenticate the request\n   */\n  appId: string\n  /**\n   * Channel name to join - users in the same channel can communicate with each other\n   */\n  channel: string\n  /**\n   * UID for local user to join the channel (default: 0)\n   */\n  uid?: number\n  /**\n   * Token used to join a channel when using secured mode (default: null)\n   */\n  token?: string | null\n  /**\n   * URL for token server, manages fetching and updating tokens automatically. Must follow the schema here - https://github.com/AgoraIO-Community/agora-token-service/\n   */\n  tokenUrl?: string\n  /**\n   * Set to true to enable active speaker callback, switches the pinned video to active speaker if you're using the pinned layout. (default: false)\n   */\n  activeSpeaker?: boolean\n  /**\n   * Once set to true, the UI Kit attempts to join the channel. Can be set to false to initialise the SDK and wait before joining the channel. (default: true)\n   */\n  callActive?: boolean\n  /**\n   * Pass in a custom RTC client, to use your own implementation of the AgoraRTCClient.\n   */\n  customRtcClient?: IAgoraRTCClient\n  /**\n   * Enables dual stream mode. (default: false)\n   */\n  enableDualStream?: boolean\n  /**\n   * Enable dual stream mode with selected fallback option. (default: disabled)\n   */\n  dualStreamMode?: RemoteStreamFallbackType\n  /**\n   * Choose between grid layout and pinned layout. (default: pinned layout)\n   */\n  layout?: layout\n  /**\n   * Set local user's role between audience and host. Use with mode set to livestreaming. (default: host)\n   */\n  role?: role\n  /**\n   * Enable the mic before joining the call. (default: true)\n   */\n  enableAudio?: boolean\n  /**\n   * Enable the camera before joining the call. Only use for initiak(default: true)\n   */\n  enableVideo?: boolean\n  /**\n   * Disable Agora RTM, this also disables the use of usernames and remote mute functionality\n   */\n  disableRtm?: boolean\n}\n\n/**\n * Props object for customising the UI Kit signalling functionality\n */\nexport interface RtmPropsInterface {\n  /**\n   * Username for the RTM Client, this value can be accessed using the userData object\n   */\n   username?: string\n   /**\n    * Token used to join an RTM channel when using secured mode (default: null)\n    */\n   token?: string | undefined\n   /**\n    * UID for local user to join the RTM channel (default: uses the RTC UID)\n    */\n   uid?: string\n   /**\n    * Show a pop up with option to accept mute request instead of directly muting the remote user (default: true), if set to false you cannot unmute users. \n    */\n   showPopUpBeforeRemoteMute?: boolean\n   /**\n    * Display RTM usernames in the Videocall (default: false)\n    */\n   displayUsername?: boolean\n}\n\n/**\n * Select a pre built layout\n */\nexport enum layout {\n  /**\n   * 0: Grid layout: each user occupies a cell in the grid\n   */\n  grid = 0,\n  /**\n   * 2: Pinned layout: MaxUser occupies the main view, the other users are in a floating view on top\n   */\n  pin = 1\n}\n\n/**\n * User role for live streaming mode\n */\ntype role = 'audience' | 'host'\n\n\nexport enum ToggleState {\n  disabled, // set as 0 - to evaluate falsy\n  enabled, // set as 1 - to evaluate truthy\n  disabling, // enabled -> disabling -> disabled\n  enabling // disabled -> enabling -> enabled\n}\n\n/**\n * Callbacks exposed by the UIKit\n */\nexport type CallbacksInterface = UIKitEventsInterface &\n  RtcEventsInterface\nexport interface UIKitEventsInterface {\n  EndCall(): void\n  ActiveSpeaker(uid: UID): void\n  ['update-user-video'](\n    tracks: [IMicrophoneAudioTrack, ICameraVideoTrack]\n  ): void\n  ['user-swap'](user: UIKitUser): void\n  ['local-user-mute-video'](status: ToggleState): void\n  ['local-user-mute-audio'](status: ToggleState): void\n  ['remote-user-mute-video'](user: UIKitUser, status: remoteTrackState): void\n  ['remote-user-mute-audio'](user: UIKitUser, status: remoteTrackState): void\n  ['leave-channel'](): void\n}\nexport interface RtcEventsInterface {\n  ['connection-state-change'](\n    curState: ConnectionState,\n    revState: ConnectionState,\n    reason?: ConnectionDisconnectedReason\n  ): void\n  ['user-joined'](user: IAgoraRTCRemoteUser): void\n  ['user-left'](user: IAgoraRTCRemoteUser, reason: string): void\n  ['user-published'](\n    user: IAgoraRTCRemoteUser,\n    mediaType: 'audio' | 'video'\n  ): void\n  ['user-unpublished'](\n    user: IAgoraRTCRemoteUser,\n    mediaType: 'audio' | 'video'\n  ): void\n  ['user-info-updated'](\n    uid: UID,\n    msg:\n      | 'mute-audio'\n      | 'mute-video'\n      | 'enable-local-video'\n      | 'unmute-audio'\n      | 'unmute-video'\n      | 'disable-local-video'\n  ): void\n  ['media-reconnect-start'](uid: UID, streamType: RemoteStreamType): void\n  ['media-reconnect-end'](uid: UID, streamType: RemoteStreamType): void\n  ['stream-type-changed'](uid: UID, streamType: RemoteStreamType): void\n  ['stream-fallback'](\n    uid: UID,\n    isFallbackOrRecover: 'fallback' | 'recover'\n  ): void\n  ['channel-media-relay-state'](\n    state: ChannelMediaRelayState,\n    code: ChannelMediaRelayError\n  ): void\n  ['channel-media-relay-event'](event: ChannelMediaRelayEvent): void\n  ['volume-indicator'](\n    result: {\n      level: number\n      uid: UID\n    }[]\n  ): void\n  ['crypt-error'](): void\n  ['token-privilege-will-expire'](): void\n  ['token-privilege-did-expire'](): void\n  ['network-quality'](stats: NetworkQuality): void\n  ['live-streaming-error'](url: string, err: AgoraRTCError): void\n  ['live-streaming-warning'](url: string, warning: AgoraRTCError): void\n  ['stream-inject-status'](\n    status: InjectStreamEventStatus,\n    uid: UID,\n    url: string\n  ): void\n  ['is-using-cloud-proxy'](isUsingProxy: boolean): void\n}\nexport interface PropsInterface {\n  /**\n   * Props used to customise the UIKit communication functionality\n   */\n  rtcProps: RtcPropsInterface\n  /**\n   * Props used to customise the UIKit signalling functionality\n   */\n  rtmProps?: RtmPropsInterface\n  /**\n   * Props used to customise the UI Kit's appearance (accepts style object for different components)\n   */\n  styleProps?: Partial<StylePropInterface>\n  /**\n   * Callbacks for different functions of the UI Kit\n   */\n  callbacks?: Partial<CallbacksInterface>\n  /**\n   * Callbacks for different functions of the UI Kit\n   */\n  rtmCallbacks?: rtmCallbacks\n}\n\n/**\n * Interface for icons supplied with the UIKit (curtosy of https://feathericons.com/)\n */\nexport interface IconsInterface {\n  /**\n   * Icon for Camera/Video mute in on state\n   */\n  videocam: string\n  /**\n   * Icon for Camera/Video mute in off state\n   */\n  videocamOff: string\n  /**\n   * Icon for Mic/Audio mute in on state\n   */\n  mic: string\n  /**\n   * Icon for Mic/Audio mute in off state\n   */\n  micOff: string\n  /**\n   * Icon to switch between device cameras\n   */\n  switchCamera: string\n  /**\n   * Icon to end the call\n   */\n  callEnd: string\n  /**\n   * Icon to swap the min user to max view\n   */\n  remoteSwap: string\n  /**\n   * Icon to close the overlay in floating layout\n   */\n  close: string\n}\n\nconst initialValue: PropsInterface = {\n  rtcProps: {\n    appId: '',\n    channel: '',\n    role: 'host'\n  },\n  rtmProps: {}\n}\n/**\n * React Context to manage the user props\n */\nconst PropsContext = React.createContext<PropsInterface>(initialValue)\n\nexport const PropsProvider = PropsContext.Provider\nexport const PropsConsumer = PropsContext.Consumer\n\nconst enum InjectStreamEventStatus {\n  /**\n   * Successfully injects the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_SUCCESS = 0,\n  /**\n   * The online media stream already exists.\n   */\n  INJECT_STREAM_STATUS_START_ALREADY_EXISTS = 1,\n  /**\n   * Injecting the online media stream is not authorized.\n   */\n  INJECT_STREAM_STATUS_START_UNAUTHORIZED = 2,\n  /**\n   * Timeout when injecting the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_TIMEOUT = 3,\n  /**\n   * Fails to inject the online media stream.\n   */\n  INJECT_STREAM_STATUS_START_FAILED = 4,\n  /**\n   * Succeessfully stops injecting the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_SUCCESS = 5,\n  /**\n   * Fails to find the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_NOT_FOUND = 6,\n  /**\n   * Stopping injecting the online media stream is not authorized.\n   */\n  INJECT_STREAM_STATUS_STOP_UNAUTHORIZED = 7,\n  /**\n   * Timeout when stopping the online media stream.\n   */\n  INJECT_STREAM_STATUS_STOP_TIMEOUT = 8,\n  INJECT_STREAM_STATUS_STOP_FAILED = 9,\n  /**\n   * The online media stream is corrupted.\n   */\n  INJECT_STREAM_STATUS_BROKEN = 10\n}\n\nexport default PropsContext\n","import React from 'react'\nimport { UIKitUser } from './PropsContext'\n\n/**\n * React context to expose user array displayed in the maximised view\n */\nconst MaxUidContext = React.createContext<UIKitUser[]>([])\n\nexport const MaxUidProvider = MaxUidContext.Provider\nexport const MaxUidConsumer = MaxUidContext.Consumer\nexport default MaxUidContext\n","import React from 'react'\nimport { UIKitUser } from './PropsContext'\n\n/**\n * React context to expose user array displayed in the minimized view\n */\nconst MinUidContext = React.createContext<UIKitUser[]>([])\n\nexport const MinUidProvider = MinUidContext.Provider\nexport const MinUidConsumer = MinUidContext.Consumer\nexport default MinUidContext\n","import React from 'react'\nimport { ILocalAudioTrack, ILocalVideoTrack } from 'agora-rtc-react'\n\nexport interface TracksContextInterface {\n  localVideoTrack: ILocalVideoTrack | null\n  localAudioTrack: ILocalAudioTrack | null\n}\n/**\n * React context that contains the local audio and video tracks. It's setup by {@link TracksConfigure}.\n */\nconst TracksContext = React.createContext<TracksContextInterface>(\n  {} as TracksContextInterface\n)\n\nexport const TracksProvider = TracksContext.Provider\nexport const TracksConsumer = TracksContext.Consumer\nexport default TracksContext\n","import { ActionType } from './RtcContext'\nimport {\n  UIKitUser,\n  remoteTrackState,\n  CallbacksInterface,\n  RemoteUIKitUser,\n  ToggleState\n} from './PropsContext'\nimport { UID } from 'agora-rtc-react'\nimport { actionTypeGuard } from './Utils/actionTypeGuard'\n\ntype stateType = { max: UIKitUser[]; min: UIKitUser[] }\n\nexport const initState = {\n  max: [\n    {\n      uid: 0,\n      hasAudio: remoteTrackState.no,\n      hasVideo: remoteTrackState.no\n    }\n  ] as UIKitUser[],\n  min: [] as UIKitUser[]\n}\n\nconst reducer = (\n  state: stateType,\n  action: ActionType<keyof CallbacksInterface>\n) => {\n  let stateUpdate: Partial<stateType> = initState\n  const uids: UID[] = [...state.max, ...state.min].map((u: UIKitUser) => u.uid)\n\n  switch (action.type) {\n    case 'update-user-video':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: remoteTrackState.subbed,\n                hasVideo: remoteTrackState.subbed\n              }\n            } else {\n              return user\n            }\n          })\n        }\n      }\n      break\n    case 'user-joined':\n      if (actionTypeGuard(action, action.type)) {\n        if (uids.indexOf(action.value[0].uid) === -1) {\n          const minUpdate: stateType['min'] = [\n            ...state.min,\n            {\n              uid: action.value[0].uid,\n              hasAudio: remoteTrackState.no,\n              hasVideo: remoteTrackState.no\n            }\n          ]\n          if (minUpdate.length === 1 && state.max[0].uid === 0) {\n            stateUpdate = {\n              max: minUpdate,\n              min: state.max\n            }\n          } else {\n            stateUpdate = {\n              min: minUpdate,\n              max: state.max\n            }\n          }\n          // console.log('new user joined!\\n', action.value[0].uid)\n        }\n      }\n      break\n    case 'user-unpublished':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.no\n                    : (state.max[0].hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.no\n                    : (state.max[0].hasVideo as remoteTrackState)\n              }\n            ],\n            min: state.min\n          }\n        } else {\n          const UIKitUser = state.min.find(\n            (user: UIKitUser) => user.uid === action.value[0].uid\n          )\n          if (UIKitUser) {\n            const minUpdate: stateType['min'] = [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0].uid\n              ),\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.no\n                    : (UIKitUser.hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.no\n                    : (UIKitUser.hasVideo as remoteTrackState)\n              }\n            ]\n            stateUpdate = {\n              min: minUpdate,\n              max: state.max\n            }\n          }\n        }\n      }\n      break\n    case 'user-published':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          stateUpdate = {\n            max: [\n              {\n                uid: action.value[0].uid,\n                hasAudio:\n                  action.value[1] === 'audio'\n                    ? remoteTrackState.subbed\n                    : (state.max[0].hasAudio as remoteTrackState),\n                hasVideo:\n                  action.value[1] === 'video'\n                    ? remoteTrackState.subbed\n                    : (state.max[0].hasVideo as remoteTrackState)\n              }\n            ],\n            min: state.min\n          }\n        } else {\n          stateUpdate = {\n            min: state.min.map((user) => {\n              if (user.uid !== action.value[0].uid) {\n                return user\n              } else {\n                return {\n                  uid: user.uid,\n                  hasAudio:\n                    action.value[1] === 'audio'\n                      ? remoteTrackState.subbed\n                      : (user.hasAudio as remoteTrackState),\n                  hasVideo:\n                    action.value[1] === 'video'\n                      ? remoteTrackState.subbed\n                      : (user.hasVideo as remoteTrackState)\n                }\n              }\n            }),\n            max: state.max\n          }\n        }\n      }\n      break\n    case 'user-left':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n          const minUpdate = [...state.min]\n          stateUpdate = {\n            max: [minUpdate.pop() as UIKitUser],\n            min: minUpdate\n          }\n        } else {\n          stateUpdate = {\n            min: state.min.filter((user) => user.uid !== action.value[0].uid),\n            max: state.max\n          }\n        }\n      }\n      break\n    case 'user-swap':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0].uid) {\n        } else {\n          stateUpdate = {\n            max: [action.value[0]],\n            min: [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0].uid\n              ),\n              state.max[0]\n            ]\n          }\n        }\n      }\n      break\n    case 'local-user-mute-video':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio as ToggleState,\n                hasVideo: action.value[0]\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: user.hasAudio as ToggleState,\n                hasVideo: action.value[0]\n              }\n            } else {\n              return user\n            }\n          })\n        }\n      }\n      break\n    case 'local-user-mute-audio':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo as ToggleState\n              }\n            } else {\n              return user\n            }\n          }),\n          max: state.max.map((user) => {\n            if (user.uid === 0) {\n              return {\n                uid: 0,\n                hasAudio: action.value[0],\n                hasVideo: user.hasVideo as ToggleState\n              }\n            } else {\n              return user\n            }\n          })\n        }\n      }\n      break\n    case 'remote-user-mute-video':\n      if (actionTypeGuard(action, action.type)) {\n        // window['track'] = action.value.videoTrack\n        // window['client'] = client\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid) {\n              return {\n                uid: user.uid,\n                hasVideo: action.value[1],\n                hasAudio: user.hasAudio\n              } as RemoteUIKitUser\n            } else return user\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasVideo: action.value[1],\n                hasAudio: user.hasAudio\n              } as RemoteUIKitUser\n            else return user\n          })\n        }\n      }\n      break\n    case 'remote-user-mute-audio':\n      if (actionTypeGuard(action, action.type)) {\n        stateUpdate = {\n          min: state.min.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasAudio: action.value[1],\n                hasVideo: user.hasVideo\n              } as RemoteUIKitUser\n            else return user\n          }),\n          max: state.max.map((user: UIKitUser) => {\n            if (user.uid === action.value[0].uid)\n              return {\n                uid: user.uid,\n                hasAudio: action.value[1],\n                hasVideo: user.hasVideo\n              } as RemoteUIKitUser\n            else return user\n          })\n        }\n      }\n      break\n    case 'leave-channel':\n      stateUpdate = initState\n      break\n    case 'ActiveSpeaker':\n      if (actionTypeGuard(action, action.type)) {\n        if (state.max[0].uid === action.value[0]) {\n          stateUpdate = { ...state }\n        } else {\n          stateUpdate = {\n            max: [\n              state.min.find(\n                (user) => user.uid === action.value[0]\n              ) as UIKitUser\n            ],\n            min: [\n              ...state.min.filter(\n                (user: UIKitUser) => user.uid !== action.value[0]\n              ),\n              state.max[0]\n            ]\n          }\n        }\n      }\n      break\n  }\n\n  // console.log('!state-update', { ...state, ...stateUpdate }, stateUpdate)\n  return { ...state, ...stateUpdate }\n}\n\nexport default reducer\n","import React, {\n  useState,\n  useEffect,\n  useContext,\n  useRef,\n  useReducer\n} from 'react'\nimport { RtcProvider } from './RtcContext'\nimport PropsContext, {\n  RtcPropsInterface,\n  UIKitUser,\n  mediaStore,\n  layout,\n  CallbacksInterface\n} from './PropsContext'\nimport { MaxUidProvider } from './MaxUidContext'\nimport { createClient, UID } from 'agora-rtc-react'\nimport { MinUidProvider } from './MinUidContext'\nimport TracksContext from './TracksContext'\nimport reducer, { initState } from './Reducer'\n\nconst useClient = createClient({ codec: 'vp8', mode: 'live' }) // pass in another client if use h264\n/**\n * React component that contains the RTC logic. It manages the user state and provides it the children components by wrapping them with context providers.\n */\nconst RtcConfigure: React.FC<Partial<RtcPropsInterface>> = (props) => {\n  const uid = useRef<UID>()\n  const { localVideoTrack, localAudioTrack } = useContext(TracksContext)\n  const { callbacks, rtcProps } = useContext(PropsContext)\n  const [ready, setReady] = useState<boolean>(false)\n  const [channelJoined, setChannelJoined] = useState<boolean>(false)\n  let joinRes: ((arg0: boolean) => void) | null = null // Resolve for canJoin -> to set canJoin to true\n  const canJoin = useRef(\n    new Promise<boolean | void>((resolve, reject) => {\n      joinRes = resolve\n      console.log(reject)\n    })\n  )\n\n  let client = useClient()\n  if (rtcProps.customRtcClient) {\n    // if customRtcClient prop is set then use custom client\n    client.removeAllListeners()\n    client = rtcProps.customRtcClient\n  }\n\n  let localVideoTrackHasPublished = false\n  let localAudioTrackHasPublished = false\n\n  const mediaStore = useRef<mediaStore>({})\n\n  let { callActive } = props\n  if (callActive === undefined) {\n    callActive = true\n  }\n\n  type stateType = { max: UIKitUser[]; min: UIKitUser[] }\n  const [uidState, dispatch] = useReducer<React.Reducer<stateType, any>>(\n    reducer,\n    initState\n  )\n\n  // init rtcEngine\n  useEffect(() => {\n    async function init() {\n      try {\n        console.log(client)\n        client.on('user-joined', async (...args) => {\n          const [remoteUser] = args\n          mediaStore.current[remoteUser.uid] = {}\n          dispatch({\n            type: 'user-joined',\n            value: args\n          })\n        })\n\n        client.on('user-published', async (...args) => {\n          // Get current peer IDs\n          const [remoteUser, mediaType] = args\n          console.log('user-published', remoteUser.uid)\n          client\n            .subscribe(remoteUser, mediaType)\n            .then((_e) => {\n              // console.log('subscribe', e)\n              mediaStore.current[remoteUser.uid][mediaType + 'Track'] =\n                remoteUser[mediaType + 'Track']\n              if (mediaType === 'audio') {\n                // eslint-disable-next-line no-unused-expressions\n                remoteUser.audioTrack?.play()\n              } else {\n                if (rtcProps.enableDualStream && rtcProps.dualStreamMode) {\n                  client.setStreamFallbackOption(\n                    remoteUser.uid,\n                    rtcProps.dualStreamMode\n                  )\n                }\n              }\n              dispatch({\n                type: 'user-published',\n                value: args\n              })\n            })\n            .catch((e) => console.log(e))\n          // }\n        })\n\n        client.on('user-unpublished', async (...args) => {\n          const [remoteUser, mediaType] = args\n          console.log('user-unpublished', remoteUser.uid)\n          if (mediaType === 'audio') {\n            // eslint-disable-next-line no-unused-expressions\n            remoteUser.audioTrack?.stop()\n          }\n          dispatch({\n            type: 'user-unpublished',\n            value: args\n          })\n        })\n\n        client.on('connection-state-change', async (...args) => {\n          const [curState, prevState, reason] = args\n          console.log('connection', prevState, curState, reason)\n          if (curState === 'CONNECTED') {\n            setChannelJoined(true)\n          } else if (curState === 'DISCONNECTED') {\n            dispatch({ type: 'leave-channel', value: null })\n          } else {\n            setChannelJoined(false)\n          }\n        })\n\n        client.on('user-left', (...args) => {\n          dispatch({\n            type: 'user-left',\n            value: args\n          })\n        })\n\n        if (rtcProps.tokenUrl) {\n          const { tokenUrl, channel, uid } = rtcProps\n          client.on('token-privilege-will-expire', async () => {\n            console.log('token will expire')\n            const res = await fetch(\n              tokenUrl + '/rtc/' + channel + '/publisher/uid/' + (uid || 0) + '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            client.renewToken(token)\n          })\n\n          client.on('token-privilege-did-expire', async () => {\n            const res = await fetch(\n              tokenUrl + '/rtc/' + channel + '/publisher/uid/' + (uid || 0) + '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            client.renewToken(token)\n          })\n        }\n\n        if (callbacks) {\n          const events: [keyof CallbacksInterface] = Object.keys(\n            callbacks\n          ) as any\n          // !!!! fix type, validate event\n          events.map((e) => {\n            try {\n              client.on(e, (...args: any[]) => {\n                ;(callbacks[e] as Function).apply(null, args)\n              })\n            } catch (e) {\n              console.log(e)\n            }\n          })\n        }\n        ;(joinRes as (arg0: boolean) => void)(true)\n        setReady(true)\n      } catch (e) {\n        console.log(e)\n      }\n    }\n\n    if (joinRes) {\n      init()\n      return () => {\n        try {\n          client.removeAllListeners()\n        } catch (e) {\n          console.log(e)\n        }\n      }\n    } else return () => {}\n  }, [rtcProps.appId]) //, ready])\n\n  // Dynamically switches channel when channel prop changes\n  useEffect(() => {\n    async function join(): Promise<void> {\n      await canJoin.current\n      const { tokenUrl, channel, uid: userUid, appId, token } = rtcProps\n      if (client) {\n        if (rtcProps.role === 'audience') {\n          client.setClientRole(rtcProps.role)\n        } else {\n          client.setClientRole('host')\n        }\n        if (tokenUrl) {\n          try {\n            const res = await fetch(\n              tokenUrl +\n                '/rtc/' +\n                channel +\n                '/publisher/uid/' +\n                (userUid || 0) +\n                '/'\n            )\n            const data = await res.json()\n            const token = data.rtcToken\n            uid.current = await client.join(appId, channel, token, userUid || 0)\n          } catch (e) {\n            console.log(e)\n          }\n        } else {\n          uid.current = await client.join(\n            appId,\n            channel,\n            token || null,\n            userUid || 0\n          )\n        }\n        // console.log('!uid: ', uid.current)\n      } else {\n        console.error('trying to join before RTC Engine was initialized')\n      }\n    }\n    if (callActive) {\n      join()\n      console.log('Attempted join: ', rtcProps.channel)\n    } else {\n      console.log('In precall - waiting to join')\n    }\n    return (): void => {\n      if (callActive) {\n        console.log('Leaving channel')\n        canJoin.current = client\n          .leave()\n          .catch((err: unknown) => console.log(err))\n      }\n    }\n  }, [rtcProps.channel, rtcProps.uid, callActive, rtcProps.tokenUrl])\n\n  // publish local stream\n  useEffect(() => {\n    async function publish() {\n      if (rtcProps.enableDualStream) {\n        await client.enableDualStream()\n      }\n      // handle publish fail if track is not enabled\n      if (localAudioTrack?.enabled && channelJoined) {\n        if (!localAudioTrackHasPublished) {\n          await client.publish([localAudioTrack]).then(() => {\n            localAudioTrackHasPublished = true\n          })\n        }\n      }\n      if (localVideoTrack?.enabled && channelJoined) {\n        if (!localVideoTrackHasPublished) {\n          await client.publish([localVideoTrack]).then(() => {\n            localVideoTrackHasPublished = true\n          })\n        }\n      }\n    }\n    console.log('Publish', localVideoTrack, localAudioTrack, callActive)\n    if (callActive) {\n      publish()\n    }\n  }, [\n    callActive,\n    localVideoTrack?.enabled,\n    localAudioTrack?.enabled,\n    channelJoined\n  ])\n\n  // update local state if tracks are not null\n  useEffect(() => {\n    if (localVideoTrack && localAudioTrack !== (null && undefined)) {\n      mediaStore.current[0] = {\n        audioTrack: localAudioTrack,\n        videoTrack: localVideoTrack\n      }\n      dispatch({\n        type: 'update-user-video',\n        value: [localAudioTrack, localVideoTrack]\n      })\n    }\n  }, [rtcProps.channel, channelJoined])\n\n  // renew token if token is updated\n  useEffect(() => {\n    if (channelJoined && rtcProps.token) {\n      client\n        .renewToken(rtcProps.token)\n        .then((e) => console.log('renewed token', e))\n    }\n  }, [rtcProps.token, channelJoined])\n\n  // set role if role is updated\n  useEffect(() => {\n    if (rtcProps.role) {\n      client\n        .setClientRole(rtcProps.role)\n        .then((e) => console.log('changed role', e))\n    }\n  }, [rtcProps.role, channelJoined])\n\n  // active speaker\n  useEffect(() => {\n    async function enableActiveSpeaker() {\n      if (rtcProps.activeSpeaker && rtcProps.layout !== layout.grid) {\n        client.on('volume-indicator', (volumes) => {\n          const highestvolumeObj = volumes.reduce(\n            (\n              highestVolume: {\n                level: number\n                uid: UID\n              },\n              volume\n            ) => {\n              if (highestVolume === null) {\n                return volume\n              } else {\n                if (volume.level > highestVolume.level) {\n                  return volume\n                }\n                return highestVolume\n              }\n            },\n            null\n          )\n          const activeSpeaker = highestvolumeObj\n            ? highestvolumeObj.uid\n            : undefined\n          const mapActiveSpeakerToZero =\n            activeSpeaker === uid.current ? 0 : activeSpeaker\n          if (activeSpeaker !== undefined) {\n            dispatch({\n              type: 'ActiveSpeaker',\n              value: [mapActiveSpeakerToZero]\n            })\n          }\n        })\n        await client.enableAudioVolumeIndicator()\n      }\n    }\n    if (callActive) {\n      enableActiveSpeaker()\n    }\n    return () => {\n      client.removeAllListeners('volume-indicator')\n    }\n  }, [rtcProps.activeSpeaker, rtcProps.layout])\n\n  return (\n    <RtcProvider\n      value={{\n        client,\n        mediaStore: mediaStore.current,\n        localVideoTrack,\n        localAudioTrack,\n        dispatch,\n        localUid: uid,\n        channelJoined\n      }}\n    >\n      <MaxUidProvider value={uidState.max}>\n        <MinUidProvider value={uidState.min}>\n          {/* <MinUidProvider value={uidState.min}> */}\n          {ready ? props.children : null}\n        </MinUidProvider>\n      </MaxUidProvider>\n    </RtcProvider>\n  )\n}\n\nexport default RtcConfigure\n","import React from 'react'\n\nconst icons = {\n  videocam: (\n    <React.Fragment>\n      <polygon points='23 7 16 12 23 17 23 7' />\n      <rect x='1' y='5' width='15' height='14' rx='2' ry='2' />\n    </React.Fragment>\n  ),\n  videocamOff: (\n    <React.Fragment>\n      <path d='M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h2m5.66 0H14a2 2 0 0 1 2 2v3.34l1 1L23 7v10' />\n      <line x1='1' y1='1' x2='23' y2='23' />\n    </React.Fragment>\n  ),\n  remoteSwap: (\n    <React.Fragment>\n      <polyline points='15 3 21 3 21 9' />\n      <polyline points='9 21 3 21 3 15' />\n      <line x1='21' y1='3' x2='14' y2='10' />\n      <line x1='3' y1='21' x2='10' y2='14' />\n    </React.Fragment>\n  ),\n  callEnd: (\n    <React.Fragment>\n      <path d='M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91' />\n      <line x1='23' y1='1' x2='1' y2='23' />\n    </React.Fragment>\n  ),\n  mic: (\n    <React.Fragment>\n      <path d='M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z' />\n      <path d='M19 10v2a7 7 0 0 1-14 0v-2' />\n      <line x1='12' y1='19' x2='12' y2='23' />\n      <line x1='8' y1='23' x2='16' y2='23' />\n    </React.Fragment>\n  ),\n  micOff: (\n    <React.Fragment>\n      <line x1='1' y1='1' x2='23' y2='23' />\n      <path d='M9 9v3a3 3 0 0 0 5.12 2.12M15 9.34V4a3 3 0 0 0-5.94-.6' />\n      <path d='M17 16.95A7 7 0 0 1 5 12v-2m14 0v2a7 7 0 0 1-.11 1.23' />\n      <line x1='12' y1='19' x2='12' y2='23' />\n      <line x1='8' y1='23' x2='16' y2='23' />\n    </React.Fragment>\n  )\n}\n\nexport default icons\n","import React, { useContext } from 'react'\nimport PropsContext from '../PropsContext'\nimport Icons from './Icons'\ninterface BtnTemplateInterface {\n  name: string\n  color?: string\n  onClick: () => void\n  disabled?: boolean\n  style?: React.CSSProperties\n}\n\nconst BtnTemplate = (props: BtnTemplateInterface) => {\n  const { onClick, name, disabled, style } = props\n  const { styleProps } = useContext(PropsContext)\n  const { theme, BtnTemplateStyles, iconSize, customIcon } = styleProps || {}\n\n  return (\n    <div\n      style={{\n        ...{\n          width: 35,\n          height: 35,\n          borderRadius: '100%',\n          borderWidth: 2,\n          borderStyle: 'solid',\n          borderColor: 'yellow',\n          backgroundColor: 'rgba(0,80,180,0.2)',\n          alignItems: 'center',\n          justifyContent: 'center',\n          display: 'flex',\n          cursor: disabled ? 'auto' : 'pointer',\n          margin: 4\n        },\n        ...BtnTemplateStyles,\n        ...style\n      }}\n      onClick={onClick}\n    >\n      {customIcon ? (\n        <img src={customIcon[name]} alt={name} />\n      ) : (\n        <svg\n          style={{\n            width: iconSize || 24,\n            height: iconSize || 24\n          }}\n          xmlns='http://www.w3.org/2000/svg'\n          width='24'\n          height='24'\n          viewBox='0 0 24 24'\n          fill='none'\n          opacity={disabled ? '0.5' : '1'}\n          stroke={theme || '#fff'}\n          strokeWidth='2'\n          strokeLinecap='round'\n          strokeLinejoin='round'\n          // className='feather feather-video'\n        >\n          {Icons[name]}\n        </svg>\n      )}\n    </div>\n  )\n}\n\nexport default BtnTemplate\n","import React, { useContext, createContext } from 'react'\nimport MaxUidContext from './MaxUidContext'\nimport MinUidContext from './MinUidContext'\nimport { LocalUIKitUser } from './PropsContext'\n\nexport const LocalContext = createContext<LocalUIKitUser>({} as LocalUIKitUser)\nexport const LocalProvider = LocalContext.Provider\nexport const LocalConsumer = LocalContext.Consumer\n\ninterface LocalUserContextInterface {\n  children: React.ReactNode\n}\n/**\n * React context that exposes the {@link LocalUIKitUser} data object\n */\nconst LocalUserContext: React.FC<LocalUserContextInterface> = (props) => {\n  const max = useContext(MaxUidContext)\n  const min = useContext(MinUidContext)\n\n  let localUser: LocalUIKitUser\n  if (max[0].uid === 0) {\n    localUser = max[0] as LocalUIKitUser\n  } else {\n    localUser = min.find((u) => u.uid === 0) as LocalUIKitUser\n  }\n  return (\n    <LocalContext.Provider value={localUser}>\n      {props.children}\n    </LocalContext.Provider>\n  )\n}\n\nexport default LocalUserContext\n","import { DispatchType } from '../../RtcContext'\nimport { LocalUIKitUser, ToggleState } from '../../PropsContext'\nimport { ILocalAudioTrack } from 'agora-rtc-react'\n\nexport default async (\n  user: LocalUIKitUser,\n  dispatch: DispatchType,\n  localAudioTrack: ILocalAudioTrack\n) => {\n  // console.log('!mute audio', user)\n  if (user.uid === 0) {\n    const localState = user.hasAudio\n    if (\n      localState === ToggleState.enabled ||\n      localState === ToggleState.disabled\n    ) {\n      // Disable UI\n      dispatch({\n        type: 'local-user-mute-audio',\n        value: [\n          localState === ToggleState.enabled\n            ? ToggleState.disabling\n            : ToggleState.enabling\n        ]\n      })\n      try {\n        await localAudioTrack?.setEnabled(localState !== ToggleState.enabled)\n        // console.log('muted audio', localState)\n        // Enable UI\n        dispatch({\n          type: 'local-user-mute-audio',\n          value: [\n            localState === ToggleState.enabled\n              ? ToggleState.disabled\n              : ToggleState.enabled\n          ]\n        })\n      } catch (e) {\n        dispatch({\n          type: 'local-user-mute-audio',\n          value: [localState]\n        })\n      }\n    }\n  }\n}\n","import React, { useContext } from 'react'\nimport RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\nimport { LocalContext } from '../../LocalUserContext'\nimport PropsContext, { ToggleState } from '../../PropsContext'\nimport muteAudio from './muteAudio'\n\nfunction LocalAudioMute() {\n  const { styleProps } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { muteLocalAudio } = localBtnStyles || {}\n  const { dispatch, localAudioTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return (\n    <div>\n      <BtnTemplate\n        style={muteLocalAudio}\n        name={local.hasAudio === ToggleState.enabled ? 'mic' : 'micOff'}\n        onClick={() =>\n          localAudioTrack && muteAudio(local, dispatch, localAudioTrack)\n        }\n      />\n    </div>\n  )\n}\n\nexport default LocalAudioMute\n","import { DispatchType } from '../../RtcContext'\nimport { LocalUIKitUser, ToggleState } from '../../PropsContext'\nimport { ILocalVideoTrack } from 'agora-rtc-react'\n\nexport default async (\n  user: LocalUIKitUser,\n  dispatch: DispatchType,\n  localVideoTrack: ILocalVideoTrack\n) => {\n  if (user.uid === 0) {\n    const localState = user.hasVideo\n    if (\n      localState === ToggleState.enabled ||\n      localState === ToggleState.disabled\n    ) {\n      // Disable UI\n      dispatch({\n        type: 'local-user-mute-video',\n        value: [\n          localState === ToggleState.enabled\n            ? ToggleState.disabling\n            : ToggleState.enabling\n        ]\n      })\n      try {\n        await localVideoTrack?.setEnabled(localState !== ToggleState.enabled)\n        // Enable UI\n        dispatch({\n          type: 'local-user-mute-video',\n          value: [\n            localState === ToggleState.enabled\n              ? ToggleState.disabled\n              : ToggleState.enabled\n          ]\n        })\n      } catch (e) {\n        dispatch({\n          type: 'local-user-mute-video',\n          value: [localState]\n        })\n      }\n    }\n  }\n}\n","import React, { useContext } from 'react'\nimport RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\nimport { LocalContext } from '../../LocalUserContext'\nimport PropsContext, { ToggleState } from '../../PropsContext'\nimport muteVideo from './muteVideo'\n\nfunction LocalVideoMute() {\n  const { styleProps } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { muteLocalVideo } = localBtnStyles || {}\n  const { dispatch, localVideoTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return (\n    <div>\n      <BtnTemplate\n        style={muteLocalVideo}\n        name={\n          local.hasVideo === ToggleState.enabled ? 'videocam' : 'videocamOff'\n        }\n        onClick={() =>\n          localVideoTrack && muteVideo(local, dispatch, localVideoTrack)\n        }\n      />\n    </div>\n  )\n}\n\nexport default LocalVideoMute\n","import React, { useContext } from 'react'\nimport LocalAudioMute from './Local/LocalAudioMute'\nimport LocalVideoMute from './Local/LocalVideoMute'\nimport PropsContext from '../PropsContext'\n\nfunction LocalControls() {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { localBtnContainer } = styleProps || {}\n\n  return (\n    <div\n      style={{\n        ...{\n          width: '100%',\n          height: 70,\n          zIndex: 10,\n          display: 'flex',\n          flexDirection: 'row',\n          justifyContent: 'space-evenly',\n          alignItems: 'center'\n        },\n        ...localBtnContainer\n      }}\n    >\n      {rtcProps.role !== 'audience' && <LocalVideoMute />}\n      {rtcProps.role !== 'audience' && <LocalAudioMute />}\n    </div>\n  )\n}\n\nexport default LocalControls\n","import { UID } from 'agora-rtc-react'\nimport { RtmClient, RtmEvents } from 'agora-rtm-react'\nimport { createContext } from 'react'\n\n/**\n * Callbacks to pass to RTM events\n */\nexport type rtmCallbacks = {\n  channel?: Partial<RtmEvents.RtmChannelEvents>\n  client?: Partial<RtmEvents.RtmClientEvents>\n}\n\nexport enum rtmStatusEnum {\n  // Initialisation failed\n  initFailed,\n  // Login has not been attempted\n  offline,\n  // RTM is initialising, process is not yet complete\n  initialising,\n  // Currently attempting to log in\n  loggingIn,\n  // RTM has logged in\n  loggedIn,\n  // RTM is logged in, and connected to the current channel\n  connected,\n  // RTM Login Failed\n  loginFailed\n}\n\nexport type messageType = 'UserData' | 'MuteRequest'\n\nexport type messageObject = userData | muteRequest | genericAction\n\nexport enum clientRoleRaw {\n  broadcaster,\n  audience\n}\n\nexport enum mutingDevice {\n  camera,\n  microphone\n}\n\nexport type genericAction = {\n  messageType: 'RtmDataRequest'\n  type: 'ping' | 'pong' | 'userData'\n}\n\nexport type muteRequest = {\n  messageType: 'MuteRequest'\n  rtcId: UID\n  mute: boolean\n  device: mutingDevice\n  isForceful: boolean\n}\n\nexport type userData = {\n  messageType: 'UserData'\n  rtmId: string\n  rtcId: UID\n  username?: string\n  role: clientRoleRaw\n  uikit: {\n    platform: string\n    framework: string\n    version: string\n  }\n  agora: {\n    rtm: string\n    rtc: string\n  }\n}\n\nexport enum popUpStateEnum {\n  closed,\n  muteMic,\n  muteCamera,\n  unmuteMic,\n  unmuteCamera\n}\n/**\n * Interface for RTM Context\n */\ninterface rtmContext {\n  /**\n   * rtm connection status\n   */\n  rtmStatus: rtmStatusEnum\n  /**\n   * send message to everyone in the channel\n   */\n  sendChannelMessage: (msg: messageObject) => void\n  /**\n   * send message to a specific user\n   */\n  sendPeerMessage: (msg: messageObject, uid: string) => void\n  /**\n   * RTM Client instance\n   */\n  rtmClient: RtmClient\n  /**\n   * map with userdata for each rtc uid in the channel\n   */\n  userDataMap: Object\n  /**\n   * map with rtm uid for each rtc uid in the channel\n   */\n  uidMap: Object\n  /**\n   * Send a mute request\n   */\n  sendMuteRequest: (device: mutingDevice, rtcId: UID, mute: boolean) => void\n  /**\n   * RTM usernames\n   */\n  usernames: {}\n  /**\n   * state to display pop up on remote mute request\n   */\n  popUpState: popUpStateEnum\n  /**\n   * set state to hide pop up\n   */\n  setPopUpState: React.Dispatch<React.SetStateAction<popUpStateEnum>>\n}\n/**\n * Context to access RTM data. It's setup by {@link RtmConfigure}.\n */\nconst RtmContext = createContext(null as unknown as rtmContext)\n\nexport const RtmProvider = RtmContext.Provider\nexport const RtmConsumer = RtmContext.Consumer\nexport default RtmContext\n","import React, { useContext } from 'react'\nimport BtnTemplate from '../BtnTemplate'\nimport PropsContext, { remoteTrackState, UIKitUser } from '../../PropsContext'\nimport RtmContext, { mutingDevice } from '../../RtmContext'\n\nfunction RemoteVideoMute(props: { UIKitUser: UIKitUser }) {\n  const { styleProps } = useContext(PropsContext)\n  const { sendMuteRequest, uidMap } = useContext(RtmContext)\n  const { remoteBtnStyles } = styleProps || {}\n  const { muteRemoteVideo } = remoteBtnStyles || {}\n  const { UIKitUser } = props\n  const isMuted = UIKitUser.hasVideo === remoteTrackState.no\n\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? (\n    <div>\n      <BtnTemplate\n        name={\n          UIKitUser.hasVideo === remoteTrackState.subbed\n            ? 'videocam'\n            : 'videocamOff'\n        }\n        style={muteRemoteVideo}\n        onClick={() =>\n          sendMuteRequest(mutingDevice.camera, UIKitUser.uid, !isMuted)\n        }\n      />\n    </div>\n  ) : null\n}\n\nexport default RemoteVideoMute\n","import React, { useContext } from 'react'\nimport BtnTemplate from '../BtnTemplate'\nimport PropsContext, { remoteTrackState, UIKitUser } from '../../PropsContext'\nimport RtmContext, { mutingDevice } from '../../RtmContext'\n\nfunction RemoteAudioMute(props: { UIKitUser: UIKitUser }) {\n  const { styleProps } = useContext(PropsContext)\n  const { remoteBtnStyles } = styleProps || {}\n  const { sendMuteRequest, uidMap } = useContext(RtmContext)\n  const { muteRemoteAudio } = remoteBtnStyles || {}\n  const { UIKitUser } = props\n  const isMuted = UIKitUser.hasAudio === remoteTrackState.no\n\n  return UIKitUser.uid !== 0 && uidMap[UIKitUser.uid] ? (\n    <div>\n      <BtnTemplate\n        style={muteRemoteAudio}\n        name={UIKitUser.hasAudio === remoteTrackState.subbed ? 'mic' : 'micOff'}\n        onClick={() =>\n          sendMuteRequest(mutingDevice.microphone, UIKitUser.uid, !isMuted)\n        }\n      />\n    </div>\n  ) : null\n}\n\nexport default RemoteAudioMute\n","import React, { useContext } from 'react'\nimport RtcContext from './../RtcContext'\nimport BtnTemplate from './BtnTemplate'\nimport { UIKitUser } from './../PropsContext'\n\nfunction SwapUser(props: { UIKitUser: UIKitUser }) {\n  const { dispatch } = useContext(RtcContext)\n  const { UIKitUser } = props\n\n  return (\n    <div>\n      <BtnTemplate\n        name='remoteSwap'\n        onClick={() => dispatch({ type: 'user-swap', value: [UIKitUser] })}\n      />\n    </div>\n  )\n}\n\nexport default SwapUser\n","import React, { useContext } from 'react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport PropsContext, { VideoPlaceholderProps } from './PropsContext'\nimport SwapUser from './Controls/SwapUser'\n/**\n * React component that is renderd when the video track is muted.\n */\nconst VideoPlaceholder = (props: VideoPlaceholderProps) => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { maxViewStyles, maxViewOverlayContainer } = styleProps || {}\n  const { user } = props\n  const { CustomVideoPlaceholder } = rtcProps\n\n  return !CustomVideoPlaceholder ? (\n    <div\n      key={user.uid}\n      style={{\n        ...style.max,\n        ...maxViewStyles\n      }}\n    >\n      <div style={style.imgContainer}>\n        <img\n          style={style.img}\n          src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGNsYXNzPSJmZWF0aGVyIGZlYXRoZXItdXNlciI+PHBhdGggZD0iTTIwIDIxdi0yYTQgNCAwIDAgMC00LTRIOGE0IDQgMCAwIDAtNCA0djIiPjwvcGF0aD48Y2lyY2xlIGN4PSIxMiIgY3k9IjciIHI9IjQiPjwvY2lyY2xlPjwvc3ZnPg=='\n        />\n      </div>\n      {props.isShown && (\n        <div\n          style={{\n            ...style.btnContainer,\n            ...maxViewOverlayContainer\n          }}\n        >\n          {props.showButtons && (\n            <React.Fragment>\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n              {props.showSwap && <SwapUser UIKitUser={user} />}\n            </React.Fragment>\n          )}\n        </div>\n      )}\n    </div>\n  ) : (\n    CustomVideoPlaceholder && CustomVideoPlaceholder({ ...props }, null)\n  )\n}\n\nconst style = {\n  max: {\n    flex: 1,\n    display: 'flex',\n    backgroundColor: '#007bff33',\n    flexDirection: 'row',\n    position: 'relative'\n  } as React.CSSProperties,\n  imgContainer: {\n    flex: 10,\n    display: 'flex',\n    justifyContent: 'center'\n  },\n  img: {\n    width: 100,\n    height: 100,\n    position: 'absolute',\n    alignSelf: 'center',\n    justifySelf: 'center',\n    margin: 'auto',\n    display: 'flex'\n  } as React.CSSProperties,\n  btnContainer: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  } as React.CSSProperties\n}\n\nexport default VideoPlaceholder\n","import React, { CSSProperties, useContext } from 'react'\nimport RtmContext from './RtmContext'\nimport PropsContext, { UIKitUser } from './PropsContext'\n\nconst Username = (props: { user: UIKitUser; style?: React.CSSProperties }) => {\n  const { usernames } = useContext(RtmContext)\n  const { rtmProps, styleProps } = useContext(PropsContext)\n  const { user } = props\n\n  return rtmProps?.displayUsername ? (\n    <p style={{ ...styles.username, ...styleProps?.usernameText }}>\n      {usernames[user.uid]}\n    </p>\n  ) : (\n    <React.Fragment />\n  )\n}\n\nconst styles = {\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  } as CSSProperties\n}\n\nexport default Username\n","import React, { CSSProperties, useContext, useState } from 'react'\nimport RtcContext from './RtcContext'\nimport { AgoraVideoPlayer, IRemoteVideoTrack } from 'agora-rtc-react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport PropsContext, { UIKitUser } from './PropsContext'\nimport VideoPlaceholder from './VideoPlaceholder'\nimport Username from './Username'\n/**\n * React component to display the user video in maximized view\n */\nconst MaxVideoView = (props: {\n  user: UIKitUser\n  style?: React.CSSProperties\n}) => {\n  const { mediaStore } = useContext(RtcContext)\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { maxViewStyles, videoMode, maxViewOverlayContainer } = styleProps || {}\n  const renderModeProp = videoMode?.max\n  const [isShown, setIsShown] = useState(false)\n  const { user } = props\n\n  return (\n    <div\n      style={{\n        ...styles.container,\n        ...props.style,\n        ...maxViewStyles\n      }}\n      onMouseEnter={() => setIsShown(true)}\n      onMouseLeave={() => setIsShown(false)}\n    >\n      {user.hasVideo === 1 ? (\n        // hasVideo is 1 if the local user has video enabled, or if remote user video is subbed\n        <div style={styles.videoContainer}>\n          {!rtcProps.disableRtm && <Username user={user} />}\n          <AgoraVideoPlayer\n            style={styles.videoplayer}\n            config={{\n              fit: renderModeProp || 'cover'\n            }}\n            videoTrack={mediaStore[user.uid].videoTrack as IRemoteVideoTrack}\n          />\n          {isShown && (\n            <div\n              style={{\n                ...styles.overlay,\n                ...maxViewOverlayContainer\n              }}\n            >\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n            </div>\n          )}\n        </div>\n      ) : (\n        <div style={styles.videoContainer}>\n          {!rtcProps.disableRtm && <Username user={user} />}\n          <VideoPlaceholder user={user} isShown={isShown} showButtons />\n        </div>\n      )}\n    </div>\n  )\n}\n\nconst styles = {\n  container: { display: 'flex', flex: 1 },\n  videoContainer: {\n    display: 'flex',\n    flex: 1,\n    position: 'relative'\n  } as CSSProperties,\n  videoplayer: {\n    width: '100%',\n    display: 'flex',\n    flex: 1\n  },\n  overlay: {\n    position: 'absolute',\n    margin: 5,\n    flexDirection: 'column',\n    display: 'flex'\n  } as CSSProperties,\n  username: {\n    position: 'absolute',\n    background: '#007bffaa',\n    padding: '2px 8px',\n    color: '#fff',\n    margin: 0,\n    bottom: 0,\n    right: 0,\n    zIndex: 90\n  } as CSSProperties\n}\n\nexport default MaxVideoView\n","import React, { useContext, useState } from 'react'\nimport RtcContext from './RtcContext'\nimport { AgoraVideoPlayer, IRemoteVideoTrack } from 'agora-rtc-react'\nimport RemoteVideoMute from './Controls/Remote/RemoteVideoMute'\nimport RemoteAudioMute from './Controls/Remote/RemoteAudioMute'\nimport SwapUser from './Controls/SwapUser'\nimport PropsContext, { UIKitUser } from './PropsContext'\nimport VideoPlaceholder from './VideoPlaceholder'\n\n/**\n * React context to expose user array displayed in the smaller view\n */\nconst MinVideoView = (props: { user: UIKitUser }) => {\n  const { mediaStore } = useContext(RtcContext)\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { minViewStyles, videoMode, minViewOverlayContainer } = styleProps || {}\n  const renderModeProp = videoMode?.min\n  const [isShown, setIsShown] = useState(false)\n  const { user } = props\n\n  return (\n    <div\n      style={{\n        ...{ display: 'flex', flex: 1 },\n        ...minViewStyles\n      }}\n      onMouseEnter={() => setIsShown(true)}\n      onMouseLeave={() => setIsShown(false)}\n    >\n      {user.hasVideo === 1 ? (\n        <div\n          style={{\n            ...{\n              display: 'flex',\n              flex: 1,\n              position: 'relative'\n            }\n          }}\n        >\n          <AgoraVideoPlayer\n            style={{ flex: 10, display: 'flex' }}\n            config={{\n              fit: renderModeProp !== undefined ? renderModeProp : 'cover'\n            }}\n            videoTrack={mediaStore[user.uid].videoTrack as IRemoteVideoTrack}\n          />\n          {isShown && (\n            <div\n              style={{\n                ...{\n                  margin: 4,\n                  position: 'absolute',\n                  flex: 1,\n                  display: 'flex',\n                  flexDirection: 'column'\n                },\n                ...minViewOverlayContainer\n              }}\n            >\n              {!rtcProps.disableRtm && <RemoteVideoMute UIKitUser={user} />}\n              {!rtcProps.disableRtm && <RemoteAudioMute UIKitUser={user} />}\n              <SwapUser UIKitUser={user} />\n            </div>\n          )}\n        </div>\n      ) : (\n        <VideoPlaceholder user={user} isShown={isShown} showButtons showSwap />\n      )}\n    </div>\n  )\n}\n\nexport default MinVideoView\n","import React, { useContext, useEffect, useRef, useState } from 'react'\nimport { MinUidConsumer } from './MinUidContext'\nimport { MaxUidConsumer } from './MaxUidContext'\nimport MaxVideoView from './MaxVideoView'\nimport MinVideoView from './MinVideoView'\nimport PropsContext from './PropsContext'\nimport styles from './styles.module.css'\n\n/**\n * React Component to render the user videos in the pinned/spotlight layout\n */\nconst PinnedVideo: React.FC = () => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const {\n    minViewContainer,\n    pinnedVideoContainer,\n    maxViewContainer,\n    scrollViewContainer\n  } = styleProps || {}\n  const parentRef = useRef<HTMLDivElement>(null)\n  const [width, setWidth] = useState(0)\n  const [height, setHeight] = useState(0)\n  const isLandscape = width > height\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth)\n        setHeight(parentRef.current.offsetHeight)\n      }\n    }\n    window.addEventListener('resize', handleResize)\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth)\n      setHeight(parentRef.current.offsetHeight)\n    }\n    return () => {\n      window.removeEventListener('resize', handleResize)\n    }\n  }, [])\n\n  return (\n    <div\n      ref={parentRef}\n      style={{\n        ...{\n          display: 'flex',\n          flex: 1,\n          flexDirection: isLandscape ? 'row' : 'column-reverse',\n          overflow: 'hidden'\n        },\n        ...pinnedVideoContainer\n      }}\n    >\n      <div\n        style={{\n          ...{\n            display: 'flex',\n            flex: isLandscape ? 5 : 4\n          },\n          ...maxViewContainer\n        }}\n      >\n        <MaxUidConsumer>\n          {(maxUsers) =>\n            rtcProps.role === 'audience' && maxUsers[0].uid === 0 ? null : (\n              <MaxVideoView user={maxUsers[0]} />\n            )\n          }\n        </MaxUidConsumer>\n      </div>\n      <div\n        className={styles.scrollbar}\n        style={{\n          ...{\n            overflowY: isLandscape ? 'scroll' : 'hidden',\n            overflowX: !isLandscape ? 'scroll' : 'hidden',\n            display: 'flex',\n            flex: 1,\n            flexDirection: isLandscape ? 'column' : 'row'\n          },\n          ...scrollViewContainer\n        }}\n      >\n        <MinUidConsumer>\n          {(minUsers) =>\n            minUsers.map((user) =>\n              rtcProps.role === 'audience' && user.uid === 0 ? null : (\n                <div\n                  style={{\n                    ...{\n                      minHeight: isLandscape ? '35vh' : '99%',\n                      minWidth: isLandscape ? '99%' : '40vw',\n                      margin: 2,\n                      display: 'flex'\n                    },\n                    ...minViewContainer\n                  }}\n                  key={user.uid}\n                >\n                  <MinVideoView user={user} />\n                </div>\n              )\n            )\n          }\n        </MinUidConsumer>\n      </div>\n    </div>\n  )\n}\n\nexport default PinnedVideo\n","import React, { useContext, useEffect, useRef, useState } from 'react'\nimport MinUidContext from './MinUidContext'\nimport MaxUidContext from './MaxUidContext'\nimport PropsContext from './PropsContext'\nimport MaxVideoView from './MaxVideoView'\n\n/**\n * React Component to render the user videos in a grid\n */\nconst GridVideo: React.FC = () => {\n  const { styleProps, rtcProps } = useContext(PropsContext)\n  const { gridVideoCells, gridVideoContainer } = styleProps || {}\n  const max = useContext(MaxUidContext)\n  const min = useContext(MinUidContext)\n  const users =\n    rtcProps.role === 'audience'\n      ? [...max, ...min].filter((user) => user.uid !== 0)\n      : [...max, ...min]\n  const parentRef = useRef<HTMLDivElement>(null)\n  const [width, setWidth] = useState(window.innerWidth)\n  const [height, setHeight] = useState(window.innerHeight)\n  const isLandscape = width > height\n  const unit = 'minmax(0, 1fr) '\n\n  useEffect(() => {\n    const handleResize = () => {\n      if (parentRef.current) {\n        setWidth(parentRef.current.offsetWidth)\n        setHeight(parentRef.current.offsetHeight)\n      }\n    }\n    window.addEventListener('resize', handleResize)\n    if (parentRef.current) {\n      setWidth(parentRef.current.offsetWidth)\n      setHeight(parentRef.current.offsetHeight)\n    }\n    return () => {\n      window.removeEventListener('resize', handleResize)\n    }\n  }, [])\n\n  return (\n    <div\n      ref={parentRef}\n      style={{\n        ...{\n          width: '100%',\n          height: '100%',\n          display: 'grid',\n          gridTemplateColumns: isLandscape\n            ? users.length > 9\n              ? unit.repeat(4)\n              : users.length > 4\n              ? unit.repeat(3)\n              : users.length > 1\n              ? unit.repeat(2)\n              : unit\n            : users.length > 8\n            ? unit.repeat(3)\n            : users.length > 2\n            ? unit.repeat(2)\n            : unit\n        },\n        ...gridVideoContainer\n      }}\n    >\n      {users.map((user) => (\n        <MaxVideoView\n          user={user}\n          style={{ ...{ height: '100%', width: '100%' }, ...gridVideoCells }}\n          key={user.uid}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default GridVideo\n","import React, { useState, useEffect, useRef } from 'react'\nimport { RtcPropsInterface, mediaStore } from './PropsContext'\nimport {\n  ILocalVideoTrack,\n  ILocalAudioTrack,\n  createMicrophoneAndCameraTracks\n} from 'agora-rtc-react'\nimport { TracksProvider } from './TracksContext'\n\nconst useTracks = createMicrophoneAndCameraTracks(\n  { encoderConfig: {} },\n  { encoderConfig: {} }\n)\n/**\n * React component that create local camera and microphone tracks and assigns them to the child components\n */\nconst TracksConfigure: React.FC<Partial<RtcPropsInterface>> = (props) => {\n  const [ready, setReady] = useState<boolean>(false)\n  const [localVideoTrack, setLocalVideoTrack] =\n    useState<ILocalVideoTrack | null>(null)\n  const [localAudioTrack, setLocalAudioTrack] =\n    useState<ILocalAudioTrack | null>(null)\n  const { ready: trackReady, tracks, error } = useTracks()\n  const mediaStore = useRef<mediaStore>({})\n\n  useEffect(() => {\n    if (tracks !== null) {\n      setLocalAudioTrack(tracks[0])\n      setLocalVideoTrack(tracks[1])\n      mediaStore.current[0] = {\n        audioTrack: tracks[0],\n        videoTrack: tracks[1]\n      }\n      setReady(true)\n    } else if (error) {\n      console.error(error)\n      setReady(false)\n    }\n    return () => {\n      if (tracks) {\n        // eslint-disable-next-line no-unused-expressions\n        tracks[0]?.close()\n        // eslint-disable-next-line no-unused-expressions\n        tracks[1]?.close()\n      }\n    }\n  }, [trackReady, error]) //, ready])\n\n  return (\n    <TracksProvider\n      value={{\n        localVideoTrack: localVideoTrack,\n        localAudioTrack: localAudioTrack\n      }}\n    >\n      {ready ? props.children : null}\n    </TracksProvider>\n  )\n}\n\nexport default TracksConfigure\n","import React, { useState, useContext, useEffect, useRef } from 'react'\nimport AgoraRTM, {\n  createLazyClient,\n  createLazyChannel,\n  RtmEvents,\n  RtmRawMessage\n} from 'agora-rtm-react'\nimport PropsContext from './PropsContext'\nimport {\n  RtmProvider,\n  muteRequest,\n  mutingDevice,\n  rtmStatusEnum,\n  userData,\n  popUpStateEnum,\n  messageObject\n} from './RtmContext'\nimport RtcContext from './RtcContext'\nimport AgoraRTC, { UID } from 'agora-rtc-react'\nimport { LocalContext } from './LocalUserContext'\nimport muteAudio from './Controls/Local/muteAudio'\nimport muteVideo from './Controls/Local/muteVideo'\n\nconst timeNow = () => new Date().getTime()\nconst useChannel = createLazyChannel()\nconst useClient = createLazyClient()\n/**\n * React component that contains the RTM logic. It manages the usernames, remote mute requests and provides data to the children components by wrapping them with context providers.\n */\nconst RtmConfigure = (props: any) => {\n  const { rtcProps, rtmProps } = useContext(PropsContext)\n  const [isLoggedIn, setLoggedIn] = useState<boolean>(false)\n  const rtmClient = useClient(rtcProps.appId)\n  const channel = useChannel(rtmClient, rtcProps.channel)\n  const localUid = useRef<string>('')\n  const timerValueRef: any = useRef(5)\n  const local = useContext(LocalContext)\n  const { rtmCallbacks } = useContext(PropsContext)\n  const [uidMap, setUidMap] = useState<Object>({})\n  const [usernames, setUsernames] = useState<Object>({})\n  const [userDataMap, setUserDataMap] = useState<Object>({})\n  const [popUpState, setPopUpState] = useState<popUpStateEnum>(\n    popUpStateEnum.closed\n  )\n  const [rtmStatus, setRtmStatus] = useState<rtmStatusEnum>(\n    rtmStatusEnum.offline\n  )\n  const {\n    localUid: rtcUid,\n    localAudioTrack,\n    localVideoTrack,\n    dispatch,\n    channelJoined\n  } = useContext(RtcContext)\n\n  const login = async () => {\n    const { tokenUrl } = rtcProps\n    if (tokenUrl) {\n      try {\n        const res = await fetch(\n          tokenUrl + '/rtm/' + (rtmProps?.uid || localUid.current)\n        )\n        const data = await res.json()\n        const serverToken = data.rtmToken\n        await rtmClient.login({\n          uid: rtmProps?.uid || localUid.current,\n          token: serverToken\n        })\n        timerValueRef.current = 5\n      } catch (error) {\n        setTimeout(async () => {\n          timerValueRef.current = timerValueRef.current + timerValueRef.current\n          login()\n        }, timerValueRef.current * 1000)\n      }\n    } else {\n      try {\n        await rtmClient.login({\n          uid: rtmProps?.uid || localUid.current,\n          token: rtmProps?.token || undefined\n        })\n        timerValueRef.current = 5\n      } catch (error) {\n        setTimeout(async () => {\n          timerValueRef.current = timerValueRef.current + timerValueRef.current\n          login()\n        }, timerValueRef.current * 1000)\n      }\n    }\n  }\n\n  const joinChannel = async () => {\n    await rtcUid\n    try {\n      await channel.join()\n      timerValueRef.current = 5\n    } catch (error) {\n      setTimeout(async () => {\n        timerValueRef.current = timerValueRef.current + timerValueRef.current\n        joinChannel()\n      }, timerValueRef.current * 1000)\n    }\n  }\n\n  const init = async () => {\n    setRtmStatus(rtmStatusEnum.initialising)\n    // rtmProps?.uid\n    //   ? (localUid.current = String(rtmProps.uid))\n    //   :\n    rtcProps.uid\n      ? (localUid.current = String(rtcProps.uid))\n      : (localUid.current = String(timeNow()))\n\n    rtmClient.on('ConnectionStateChanged', (state, reason) => {\n      console.log(state, reason)\n    })\n\n    rtmClient.on('TokenExpired', async () => {\n      const { tokenUrl } = rtcProps\n      console.log('token expired - renewing')\n      if (tokenUrl) {\n        try {\n          const res = await fetch(\n            tokenUrl + '/rtm/' + (rtmProps?.uid || localUid.current)\n          )\n          const data = await res.json()\n          const serverToken = data.rtmToken\n          await rtmClient.renewToken(serverToken)\n          timerValueRef.current = 5\n        } catch (error) {\n          console.error('TokenExpiredError', error)\n        }\n      }\n    })\n\n    rtmClient.on('MessageFromPeer', (message, peerId) => {\n      handleReceivedMessage(message as RtmRawMessage, peerId)\n    })\n\n    channel.on('ChannelMessage', (message, peerId) => {\n      handleReceivedMessage(message as RtmRawMessage, peerId)\n    })\n\n    channel.on('MemberJoined', async (peerId) => {\n      await sendPeerMessage(createUserData(), peerId)\n    })\n    channel.on('MemberCountUpdated', async (count) => {\n      console.log('RTM-MemberCountUpdated: ', count)\n    })\n\n    // handle RTM callbacks\n    if (rtmCallbacks?.channel) {\n      Object.keys(rtmCallbacks.channel).map((callback) => {\n        if (rtmCallbacks.channel) {\n          channel.on(\n            callback as keyof RtmEvents.RtmChannelEvents,\n            rtmCallbacks.channel[callback]\n          )\n        }\n      })\n    } else if (rtmCallbacks?.client) {\n      Object.keys(rtmCallbacks.client).map((callback) => {\n        if (rtmCallbacks.client) {\n          rtmClient.on(\n            callback as keyof RtmEvents.RtmClientEvents,\n            rtmCallbacks.client[callback]\n          )\n        }\n      })\n    }\n\n    if (rtcProps.tokenUrl) {\n      const { tokenUrl, uid } = rtcProps\n      rtmClient.on('TokenExpired', async () => {\n        console.log('token expired')\n        const res = await fetch(tokenUrl + '/rtm/' + (uid || 0) + '/')\n        const data = await res.json()\n        const token = data.rtmToken\n        rtmClient.renewToken(token)\n      })\n    }\n\n    setRtmStatus(rtmStatusEnum.loggingIn)\n    await login()\n    setRtmStatus(rtmStatusEnum.loggedIn)\n    await joinChannel()\n    setRtmStatus(rtmStatusEnum.connected)\n    // console.log('!rtcUid', rtcUid, channelJoined)\n    setUsernames((p) => {\n      return { ...p, 0: rtmProps?.username }\n    })\n    sendChannelMessage(createUserData())\n  }\n\n  const createUserData = () => {\n    return {\n      messageType: 'UserData',\n      rtmId: rtmProps?.uid || localUid.current,\n      rtcId: rtcUid.current,\n      username: rtmProps?.username,\n      role: rtcProps.role === 'audience' ? 1 : 0,\n      uikit: {\n        platform: 'web',\n        framework: 'react',\n        version: '0.1.0'\n      },\n      agora: {\n        rtm: AgoraRTM.VERSION,\n        rtc: AgoraRTC.VERSION\n      }\n    } as userData\n  }\n\n  const sendMuteRequest = (device: mutingDevice, rtcId: UID, mute: boolean) => {\n    const forced = rtmProps?.showPopUpBeforeRemoteMute === false\n    const payload: muteRequest = {\n      messageType: 'MuteRequest',\n      device,\n      rtcId,\n      mute,\n      isForceful: forced\n    }\n    const peerId = uidMap[rtcId]\n    if (forced && !mute) {\n      console.log('cannot send force unmute request')\n    } else if (peerId) {\n      sendPeerMessage(payload, peerId)\n    } else {\n      console.log('peer not found')\n    }\n  }\n\n  const handleReceivedMessage = (message: RtmRawMessage, peerId: string) => {\n    const payload = (message as RtmRawMessage).rawMessage\n    const messageObject: messageObject = parsePayload(payload)\n    console.log(messageObject, peerId)\n    switch (messageObject.messageType) {\n      case 'UserData':\n        handleReceivedUserDataMessage(messageObject)\n        break\n      case 'MuteRequest':\n        handleReceivedMuteMessage(messageObject)\n        break\n      case 'RtmDataRequest':\n        switch (messageObject.type) {\n          case 'ping':\n            handlePing(peerId)\n            break\n          case 'userData':\n            handleUserDataRequest(peerId)\n            break\n          default:\n            console.log(peerId)\n        }\n        break\n      default:\n        console.log('unknown message type')\n    }\n  }\n\n  const handleReceivedUserDataMessage = (userData: userData) => {\n    setUidMap((p) => {\n      return { ...p, [userData.rtcId]: userData.rtmId }\n    })\n    setUsernames((p) => {\n      return { ...p, [userData.rtcId]: userData.username }\n    })\n    setUserDataMap((p) => {\n      return { ...p, [userData.rtmId]: userData }\n    })\n    // console.log('userData', userData, userDataMap, uidMap)\n  }\n\n  const handleReceivedMuteMessage = (muteRequest: muteRequest) => {\n    // console.log('!muteRequest', muteRequest)\n    if (rtcUid.current === muteRequest.rtcId) {\n      if (muteRequest.isForceful) {\n        if (muteRequest.mute) {\n          if (muteRequest.device === mutingDevice.microphone) {\n            localAudioTrack && muteAudio(local, dispatch, localAudioTrack)\n          } else if (muteRequest.device === mutingDevice.camera) {\n            localVideoTrack && muteVideo(local, dispatch, localVideoTrack)\n          }\n        } else console.error('cannot force unmute')\n      } else {\n        if (muteRequest.device === mutingDevice.microphone) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteMic)\n          else setPopUpState(popUpStateEnum.unmuteMic)\n        } else if (muteRequest.device === mutingDevice.camera) {\n          if (muteRequest.mute) setPopUpState(popUpStateEnum.muteCamera)\n          else setPopUpState(popUpStateEnum.unmuteCamera)\n        }\n      }\n    }\n  }\n\n  const handlePing = (peerId: string) => {\n    sendPeerMessage({ messageType: 'RtmDataRequest', type: 'pong' }, peerId)\n  }\n\n  const handleUserDataRequest = (peerId: string) => {\n    sendPeerMessage(createUserData(), peerId)\n  }\n\n  const sendChannelMessage = async (payload: messageObject) => {\n    const rawMessage = createRawMessage(payload)\n    const message = rtmClient.createMessage({\n      rawMessage: rawMessage,\n      messageType: AgoraRTM.MessageType.RAW,\n      description: 'AgoraUIKit'\n    })\n    await channel.sendMessage(message)\n  }\n\n  const sendPeerMessage = async (payload: messageObject, peerId: string) => {\n    const rawMessage = createRawMessage(payload)\n    const message = rtmClient.createMessage({\n      rawMessage: rawMessage,\n      messageType: AgoraRTM.MessageType.RAW,\n      description: 'AgoraUIKit'\n    })\n    await rtmClient.sendMessageToPeer(message, peerId)\n  }\n\n  const end = async () => {\n    await rtmClient.logout()\n    // await channel.leave()\n    await rtmClient.removeAllListeners()\n    // await channel.removeAllListeners()\n  }\n\n  useEffect(() => {\n    // if RTC has joined channel then init\n    if (channelJoined) {\n      init()\n      setLoggedIn(true)\n    }\n    return () => {\n      if (channelJoined) {\n        end()\n      }\n    }\n  }, [rtcProps.channel, rtcProps.appId, channelJoined])\n\n  return (\n    <RtmProvider\n      value={{\n        rtmStatus,\n        sendPeerMessage,\n        sendChannelMessage,\n        sendMuteRequest,\n        rtmClient,\n        uidMap,\n        usernames,\n        userDataMap,\n        popUpState,\n        setPopUpState\n      }}\n    >\n      {isLoggedIn ? props.children : <React.Fragment />}\n    </RtmProvider>\n  )\n}\n\nconst enc = new TextEncoder()\nconst dec = new TextDecoder()\n\n/**\n * Create an RTM raw message from any serilizable JS Object, decode using the {@link parsePayload} function\n * @param msg message object\n * @returns Uint8Array\n */\nexport const createRawMessage = (msg: any) => {\n  return enc.encode(JSON.stringify(msg))\n}\n/**\n * Decode the received RTM message or message created using {@link createRawMessage}\n * @param data encoded raw RTM message\n * @returns JS Object\n */\nexport const parsePayload = (data: BufferSource) => {\n  return JSON.parse(dec.decode(data))\n}\n\nexport default RtmConfigure\n","import React, { CSSProperties, useContext } from 'react'\nimport PropsContext from '../../PropsContext'\nimport RtmContext, { popUpStateEnum } from '../../RtmContext'\nimport RtcContext from '../../RtcContext'\nimport muteVideo from '../Local/muteVideo'\nimport { LocalContext } from '../../LocalUserContext'\nimport muteAudio from '../Local/muteAudio'\n\nfunction PopUp() {\n  const { styleProps } = useContext(PropsContext)\n  const { popUpState, setPopUpState } = useContext(RtmContext)\n  const { popUpContainer } = styleProps || {}\n  const { dispatch, localVideoTrack, localAudioTrack } = useContext(RtcContext)\n  const local = useContext(LocalContext)\n\n  return popUpState !== popUpStateEnum.closed ? (\n    <div\n      style={{\n        ...styles.container,\n        ...popUpContainer\n      }}\n    >\n      <div style={{ color: '#fff', fontSize: 18, fontWeight: 700 }}>\n        {popUpState === popUpStateEnum.muteCamera ||\n        popUpState === popUpStateEnum.muteMic\n          ? 'Mute '\n          : 'Unmute '}\n        {popUpState === popUpStateEnum.muteCamera ||\n        popUpState === popUpStateEnum.unmuteCamera\n          ? 'Camera'\n          : 'Mic'}\n        ?\n      </div>\n      <div\n        style={{\n          flexDirection: 'row',\n          display: 'flex',\n          width: '100%',\n          justifyContent: 'space-around'\n        }}\n      >\n        <div\n          onClick={() => {\n            switch (popUpState) {\n              case popUpStateEnum.muteCamera:\n                local.hasVideo &&\n                  localVideoTrack &&\n                  muteVideo(local, dispatch, localVideoTrack)\n                break\n              case popUpStateEnum.muteMic:\n                local.hasAudio &&\n                  localAudioTrack &&\n                  muteAudio(local, dispatch, localAudioTrack)\n                break\n              case popUpStateEnum.unmuteCamera:\n                !local.hasVideo &&\n                  localVideoTrack &&\n                  muteVideo(local, dispatch, localVideoTrack)\n                break\n              case popUpStateEnum.unmuteMic:\n                !local.hasAudio &&\n                  localAudioTrack &&\n                  muteAudio(local, dispatch, localAudioTrack)\n                break\n            }\n            setPopUpState(popUpStateEnum.closed)\n          }}\n          style={styles.button}\n        >\n          Confirm\n        </div>\n        <div\n          style={styles.buttonClose}\n          onClick={() => setPopUpState(popUpStateEnum.closed)}\n        >\n          Close\n        </div>\n      </div>\n    </div>\n  ) : null\n}\n\nconst styles = {\n  button: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  } as CSSProperties,\n  buttonClose: {\n    color: '#fff',\n    cursor: 'pointer',\n    borderWidth: 2,\n    borderStyle: 'solid',\n    borderColor: '#fff',\n    padding: '2px 4px',\n    borderRadius: 4\n  },\n  container: {\n    backgroundColor: '#007bffaa',\n    position: 'absolute',\n    width: 240,\n    height: 80,\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)',\n    zIndex: 100,\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'space-evenly',\n    alignItems: 'center'\n  } as CSSProperties\n}\n\nexport default PopUp\n","/**\n * @module AgoraUIKit\n */\nimport React, { useContext } from 'react'\nimport RtcConfigure from './RTCConfigure'\nimport PropsContext, {\n  PropsProvider,\n  PropsInterface,\n  layout\n} from './PropsContext'\nimport LocalControls from './Controls/LocalControls'\nimport PinnedVideo from './PinnedVideo'\nimport GridVideo from './GridVideo'\nimport TracksConfigure from './TracksConfigure'\nimport RtmConfigure from './RTMConfigure'\nimport LocalUserContext from './LocalUserContext'\nimport PopUp from './Controls/Remote/RemoteMutePopUp'\n\n/**\n * High level component to render the UI Kit\n * @param props {@link PropsInterface}\n */\nconst AgoraUIKit: React.FC<PropsInterface> = (props) => {\n  const { styleProps, rtcProps } = props\n  const { UIKitContainer } = styleProps || {}\n\n  return (\n    <PropsProvider value={props}>\n      <div\n        style={{\n          ...style,\n          ...UIKitContainer\n        }}\n      >\n        {rtcProps.role === 'audience' ? (\n          <VideocallUI />\n        ) : (\n          <TracksConfigure>\n            <VideocallUI />\n          </TracksConfigure>\n        )}\n      </div>\n    </PropsProvider>\n  )\n}\n\nexport const VideocallUI = () => {\n  const { rtcProps } = useContext(PropsContext)\n  return (\n    <RtcConfigure callActive={rtcProps.callActive}>\n      <LocalUserContext>\n        {rtcProps.disableRtm ? (\n          <React.Fragment>\n            {rtcProps?.layout === layout.grid ? <GridVideo /> : <PinnedVideo />}\n            <LocalControls />\n          </React.Fragment>\n        ) : (\n          <RtmConfigure>\n            <PopUp />\n            {rtcProps?.layout === layout.grid ? <GridVideo /> : <PinnedVideo />}\n            <LocalControls />\n          </RtmConfigure>\n        )}\n      </LocalUserContext>\n    </RtcConfigure>\n  )\n}\n\nconst style = {\n  display: 'flex',\n  flex: 1,\n  minHeight: 0,\n  flexDirection: 'column'\n} as React.CSSProperties\n\nexport default AgoraUIKit\n","import React, { useContext } from 'react'\nimport PropsContext from '../../PropsContext'\n// import RtcContext from '../../RtcContext'\nimport BtnTemplate from '../BtnTemplate'\n\nfunction EndCall() {\n  const { styleProps, callbacks } = useContext(PropsContext)\n  const { localBtnStyles } = styleProps || {}\n  const { endCall } = localBtnStyles || {}\n  // const { dispatch } = useContext(RtcContext)\n\n  return (\n    <BtnTemplate\n      style={endCall || { backgroundColor: '#ef5588', borderColor: '#f00' }}\n      name='callEnd'\n      onClick={() => callbacks?.EndCall && callbacks.EndCall()}\n    />\n  )\n}\n\nexport default EndCall\n"],"names":["RtcContext","React","createContext","RtcProvider","Provider","RtcConsumer","Consumer","remoteTrackState","layout","ToggleState","initialValue","rtcProps","appId","channel","role","rtmProps","PropsContext","PropsProvider","MaxUidContext","MaxUidProvider","MaxUidConsumer","MinUidContext","MinUidProvider","MinUidConsumer","TracksContext","TracksProvider","initState","max","uid","hasAudio","no","hasVideo","min","reducer","state","action","stateUpdate","uids","map","u","type","user","subbed","indexOf","value","minUpdate","length","UIKitUser","find","filter","pop","useClient","createClient","codec","mode","RtcConfigure","props","useRef","localVideoTrack","localAudioTrack","useContext","callbacks","ready","setReady","useState","channelJoined","setChannelJoined","joinRes","canJoin","Promise","resolve","reject","console","log","client","customRtcClient","removeAllListeners","localVideoTrackHasPublished","localAudioTrackHasPublished","mediaStore","callActive","undefined","uidState","dispatch","useReducer","useEffect","init","on","args","remoteUser","current","mediaType","subscribe","then","_e","audioTrack","play","enableDualStream","dualStreamMode","setStreamFallbackOption","catch","e","stop","curState","prevState","reason","tokenUrl","res","fetch","data","json","token","rtcToken","renewToken","events","Object","keys","apply","join","userUid","setClientRole","error","leave","err","publish","enabled","videoTrack","enableActiveSpeaker","activeSpeaker","grid","volumes","highestvolumeObj","reduce","highestVolume","volume","level","mapActiveSpeakerToZero","enableAudioVolumeIndicator","localUid","children","icons","videocam","Fragment","points","x","y","width","height","rx","ry","videocamOff","d","x1","y1","x2","y2","remoteSwap","callEnd","mic","micOff","BtnTemplate","onClick","name","disabled","style","styleProps","theme","BtnTemplateStyles","iconSize","customIcon","borderRadius","borderWidth","borderStyle","borderColor","backgroundColor","alignItems","justifyContent","display","cursor","margin","src","alt","xmlns","viewBox","fill","opacity","stroke","strokeWidth","strokeLinecap","strokeLinejoin","Icons","LocalContext","LocalUserContext","localUser","localState","disabling","enabling","setEnabled","LocalAudioMute","localBtnStyles","muteLocalAudio","local","muteAudio","LocalVideoMute","muteLocalVideo","muteVideo","LocalControls","localBtnContainer","zIndex","flexDirection","rtmStatusEnum","clientRoleRaw","mutingDevice","popUpStateEnum","RtmContext","RtmProvider","RtmConsumer","RemoteVideoMute","sendMuteRequest","uidMap","remoteBtnStyles","muteRemoteVideo","isMuted","camera","RemoteAudioMute","muteRemoteAudio","microphone","SwapUser","VideoPlaceholder","maxViewStyles","maxViewOverlayContainer","CustomVideoPlaceholder","key","imgContainer","img","isShown","btnContainer","showButtons","disableRtm","showSwap","flex","position","alignSelf","justifySelf","Username","usernames","displayUsername","styles","username","usernameText","background","padding","color","bottom","right","MaxVideoView","videoMode","renderModeProp","setIsShown","container","onMouseEnter","onMouseLeave","videoContainer","AgoraVideoPlayer","videoplayer","config","fit","overlay","MinVideoView","minViewStyles","minViewOverlayContainer","PinnedVideo","minViewContainer","pinnedVideoContainer","maxViewContainer","scrollViewContainer","parentRef","setWidth","setHeight","isLandscape","handleResize","offsetWidth","offsetHeight","window","addEventListener","removeEventListener","ref","overflow","maxUsers","className","scrollbar","overflowY","overflowX","minUsers","minHeight","minWidth","GridVideo","gridVideoCells","gridVideoContainer","users","innerWidth","innerHeight","unit","gridTemplateColumns","repeat","useTracks","createMicrophoneAndCameraTracks","encoderConfig","TracksConfigure","setLocalVideoTrack","setLocalAudioTrack","trackReady","tracks","close","timeNow","Date","getTime","useChannel","createLazyChannel","createLazyClient","RtmConfigure","isLoggedIn","setLoggedIn","rtmClient","timerValueRef","rtmCallbacks","setUidMap","setUsernames","userDataMap","setUserDataMap","popUpState","setPopUpState","closed","rtmStatus","setRtmStatus","offline","rtcUid","login","serverToken","rtmToken","setTimeout","joinChannel","initialising","String","message","peerId","handleReceivedMessage","sendPeerMessage","createUserData","count","callback","loggingIn","loggedIn","connected","p","sendChannelMessage","messageType","rtmId","rtcId","uikit","platform","framework","version","agora","rtm","AgoraRTM","VERSION","rtc","AgoraRTC","device","mute","forced","showPopUpBeforeRemoteMute","payload","isForceful","rawMessage","messageObject","parsePayload","handleReceivedUserDataMessage","handleReceivedMuteMessage","handlePing","handleUserDataRequest","userData","muteRequest","muteMic","unmuteMic","muteCamera","unmuteCamera","createRawMessage","createMessage","MessageType","RAW","description","sendMessage","sendMessageToPeer","end","logout","enc","TextEncoder","dec","TextDecoder","msg","encode","JSON","stringify","parse","decode","PopUp","popUpContainer","fontSize","fontWeight","button","buttonClose","top","left","transform","AgoraUIKit","UIKitContainer","VideocallUI","EndCall","endCall"],"mappings":"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"}